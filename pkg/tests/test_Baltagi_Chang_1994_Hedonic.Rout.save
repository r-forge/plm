
R version 3.4.2 (2017-09-28) -- "Short Summer"
Copyright (C) 2017 The R Foundation for Statistical Computing
Platform: x86_64-w64-mingw32/x64 (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> ## Test of unbalanced random effects estimator on Hedonic data of Harrison/Rubinfeld (1978)
> 
> ## NB: Baltagi's text book, table 9.1 uses the Stata results, the original paper Baltagi/Chang (1994) what EViews and plm yields
> 
> library(plm)
Loading required package: Formula
> # scaling of variables in dataset Hedonic is a little bit different to Baltagi/Chang (1994) and Baltagi's text book, table 9.1
> # see below for scaling as in Baltagi/Chang (1994)
> data("Hedonic", package = "plm")
> pHedonic <- pdata.frame(Hedonic, index = "townid")
> form <- formula(mv ~ crim + zn + indus + chas + nox + rm + age + dis + rad + tax + ptratio + blacks + lstat)
> summary(plm(form, data = pHedonic, model = "random"))
Oneway (individual) effect Random Effect Model 
   (Swamy-Arora's transformation)

Call:
plm(formula = form, data = pHedonic, model = "random")

Unbalanced Panel: n = 92, T = 1-30, N = 506

Effects:
                  var std.dev share
idiosyncratic 0.01696 0.13025 0.562
individual    0.01324 0.11505 0.438
theta:
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.2505  0.5483  0.6284  0.6141  0.7147  0.7976 

Residuals:
    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
-0.62902 -0.06712 -0.00156 -0.00216  0.06858  0.54973 

Coefficients:
               Estimate  Std. Error  t-value  Pr(>|t|)    
(Intercept)  9.6859e+00  1.9751e-01  49.0398 < 2.2e-16 ***
crim        -7.4120e-03  1.0478e-03  -7.0738 5.211e-12 ***
zn           7.8877e-05  6.5001e-04   0.1213 0.9034662    
indus        1.5563e-03  4.0349e-03   0.3857 0.6998718    
chasyes     -4.4247e-03  2.9212e-02  -0.1515 0.8796662    
nox         -5.8425e-03  1.2452e-03  -4.6921 3.510e-06 ***
rm           9.0552e-03  1.1886e-03   7.6182 1.331e-13 ***
age         -8.5787e-04  4.6793e-04  -1.8333 0.0673581 .  
dis         -1.4442e-01  4.4094e-02  -3.2753 0.0011301 ** 
rad          9.5984e-02  2.6611e-02   3.6069 0.0003415 ***
tax         -3.7740e-04  1.7693e-04  -2.1331 0.0334132 *  
ptratio     -2.9476e-02  9.0698e-03  -3.2499 0.0012336 ** 
blacks       5.6278e-01  1.0197e-01   5.5188 5.529e-08 ***
lstat       -2.9107e-01  2.3927e-02 -12.1650 < 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Total Sum of Squares:    987.94
Residual Sum of Squares: 8.9988
R-Squared:      0.99091
Adj. R-Squared: 0.99067
F-statistic: 4117.13 on 13 and 492 DF, p-value: < 2.22e-16
> 
> ## do (weired) scaling of variables as in Baltagi/Chang (1994)
> Hedonic$mv2      <- Hedonic$mv
> Hedonic$crim2    <- Hedonic$crim / 100
> Hedonic$zn2      <- Hedonic$zn / 1000
> Hedonic$indus2   <- Hedonic$indus / 100
> Hedonic$chas2    <- (as.numeric(Hedonic$chas)-1) / 10
> Hedonic$nox2     <- Hedonic$nox / 100
> Hedonic$rm2      <- Hedonic$rm / 100
> Hedonic$age2     <- Hedonic$age / 1000
> Hedonic$dis2     <- Hedonic$dis / 10
> Hedonic$rad2     <- Hedonic$rad / 10
> Hedonic$tax2     <- Hedonic$tax / 1000
> Hedonic$ptratio2 <- Hedonic$ptratio / 100
> Hedonic$lstat2   <- Hedonic$lstat / 10
> 
> pHedonic2 <- pdata.frame(Hedonic, index = "townid")
> form2 <- formula(mv2 ~ crim2 + zn2 + indus2 + chas2 + nox2 + rm2 + age2 + dis2 + rad2 + tax2 + ptratio2 + blacks + lstat2)
> summary(plm(form2, data = pHedonic2, model = "random"))
Oneway (individual) effect Random Effect Model 
   (Swamy-Arora's transformation)

Call:
plm(formula = form2, data = pHedonic2, model = "random")

Unbalanced Panel: n = 92, T = 1-30, N = 506

Effects:
                  var std.dev share
idiosyncratic 0.01696 0.13025 0.562
individual    0.01324 0.11505 0.438
theta:
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.2505  0.5483  0.6284  0.6141  0.7147  0.7976 

Residuals:
    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
-0.62902 -0.06712 -0.00156 -0.00216  0.06858  0.54973 

Coefficients:
             Estimate Std. Error  t-value  Pr(>|t|)    
(Intercept)  9.685867   0.197510  49.0398 < 2.2e-16 ***
crim2       -0.741197   0.104781  -7.0738 5.211e-12 ***
zn2          0.078877   0.650012   0.1213 0.9034662    
indus2       0.155634   0.403491   0.3857 0.6998718    
chas2       -0.044247   0.292118  -0.1515 0.8796662    
nox2        -0.584251   0.124518  -4.6921 3.510e-06 ***
rm2          0.905517   0.118863   7.6182 1.331e-13 ***
age2        -0.857873   0.467933  -1.8333 0.0673581 .  
dis2        -1.444184   0.440937  -3.2753 0.0011301 ** 
rad2         0.959839   0.266109   3.6069 0.0003415 ***
tax2        -0.377396   0.176926  -2.1331 0.0334132 *  
ptratio2    -2.947578   0.906984  -3.2499 0.0012336 ** 
blacks       0.562775   0.101974   5.5188 5.529e-08 ***
lstat2      -2.910749   0.239273 -12.1650 < 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Total Sum of Squares:    987.94
Residual Sum of Squares: 8.9988
R-Squared:      0.99091
Adj. R-Squared: 0.99067
F-statistic: 4117.13 on 13 and 492 DF, p-value: < 2.22e-16
> 
> proc.time()
   user  system elapsed 
   2.43    0.14    2.55 
